---
import { marker, rangeParser } from "@/markdown-manager/plugins/code-snippets";

export interface Props {
	title: string;
	language: string;
	mark: string;
	add: string;
	delete: string;
	children: string[];
}

const { title, language: lang, mark, add, delete: del, children } = Astro.props;

const lineOptions = new rangeParser().getLineOpts({ mark, add, del });

const codeSnippet = marker.codeToHtml(children[0]!, { lang, lineOptions });
---

<figure class="code-snippet">
	<figcaption class="code-title">{title}</figcaption>
	<Fragment set:html={codeSnippet} />
	<button aria-label="copy" class="code-copy" data-copy={codeSnippet}>
		<svg
			aria-hidden="true"
			height="16"
			viewBox="0 0 16 16"
			version="1.1"
			width="16"
		>
			<path
				fill-rule="evenodd"
				d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"
			></path>
			<path
				fill-rule="evenodd"
				d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"
			></path>
		</svg>
	</button>
</figure>

<style lang="sass" is:global>
	:root
		--s-foreground: "#24292f"
		--s-background: "#ffffff"
		--s-highlight-bg: "#eaeef280"
		--s-editor-line: "#8c959f"
		--s-indent-bg: "#24292f1f"
		--s-indent-bg-active: "#24292f3d"
		--s-whitespace: "#afb8c1"
		--s-highlight-border: "#afb8c199"
		--s-bracket-bg: "#54aeff40"
		--s-bracket-border: "#54aeff99"
		--s-bracket-fg1: "#0550ae"
		--s-bracket-fg2: "#9a6700"
		--s-bracket-fg3: "#b35900"
		--s-bracket-fg4: "#8250df"
		--s-bracket-fg5: "#57606a"
		--s-comment: "#6e7781"
		--s-constant: "#b35900"
		--s-entity: "#0550ae"
		--s-export: "#8a4600"
		--s-params: "#24292f"
		--s-json-props: "#0550ae"
		--s-string: "#0a3069"
		--s-invalid: "#6f3800"
		--s-carriage: "#f6f8fa"
		--s-deleted: "#fff5e8"
		--s-inserted: "#ddf4ff"
		--s-changed: "#ffddb0"
		--s-ignored: "#eaeef2"

	html.dark
		--s-foreground: "#c9d1d9"
		--s-background: "#0d1117"
		--s-highlight-bg: "#6e76811a"
		--s-editor-line: "#6e7681"
		--s-indent-bg: "#c9d1d91f"
		--s-indent-bg-active: "#c9d1d93d"
		--s-whitespace: "#484f58"
		--s-highlight-border: "#6e768199"
		--s-bracket-bg: "#58a6ff40"
		--s-bracket-border: "#58a6ff99"
		--s-bracket-fg1: "#79c0ff"
		--s-bracket-fg2: "#e3b341"
		--s-bracket-fg3: "#fdac54"
		--s-bracket-fg4: "#d2a8ff"
		--s-bracket-fg5: "#8b949e"
		--s-comment: "#8b949e"
		--s-constant: "#ec8e2c"
		--s-entity: "#79c0ff"
		--s-export: "#fdac54"
		--s-params: "#c9d1d9"
		--s-json-props: "#a5d6ff"
		--s-string: "#a5d6ff"
		--s-invalid: "#fdac54"
		--s-carriage: "#f0f6fc"
		--s-deleted: "#331c04"
		--s-inserted: "#051d4d"
		--s-changed: "#4e2906"
		--s-ignored: "#161b22"
</style>
